<div class="container">

  <div class="header">
    <h1>Gestion des Produits</h1>

    <div class="search-box">
      <input type="text" placeholder="Rechercher par nom ou référence..." [(ngModel)]="searchTerm"
        (input)="rechercherProduit()" />
    </div>

    <button class="btn" (click)="openModal()">+ Ajouter</button>
  </div>

  <div class="table-container" *ngIf="produits && produits.length > 0; else noData">
    <table>
      <thead>
        <tr>
          <th>Id</th>
          <th>Nom</th>
          <th>Référence</th>
          <th>Quantité</th>
          <th>Prix</th>
          <th>Act</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let produit of produits">
          <td data-label="Id">{{ produit.id }}</td>
          <td data-label="Nom du Produit">{{ produit.nom }}</td>
          <td data-label="Référence">{{ produit.ref }}</td>
          <td data-label="Quantité">{{ produit.qte }}</td>
          <td data-label="Prix Unitaire">{{ produit.prix | number:'1.0-0' }}</td>
          <td>
            <button  type="button" class="btn btn-warning btn-sm me-1"
              title="Modifier">
              <i class="fas fa-pencil-alt"></i>
            </button>

            <button  type="button" class="btn "
              title="Supprimer">
              <i class="fas fa-trash"></i>
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <ng-template #noData>
    <p>Aucun produit trouvé.</p>
  </ng-template>
</div>

<!-- ✅ Modal -->
<div class="modal" *ngIf="showModal">
  <div class="modal-content">
    <span class="close" (click)="closeModal()">&times;</span>
    <h2>Ajouter un produit</h2>

    <form (ngSubmit)="ajouterProduit()" #produitForm="ngForm">
      <label>Nom</label>
      <input type="text" name="nom" [(ngModel)]="nouveauProduit.nom" required />

      <label>Référence</label>
      <input type="text" name="reference" [(ngModel)]="nouveauProduit.ref" required />

      <label>Quantité</label>
      <input type="number" name="quantite" [(ngModel)]="nouveauProduit.qte" required />

      <label>Prix Unitaire</label>
      <input type="number" name="prixUnitaire" [(ngModel)]="nouveauProduit.prix" required />

      <button type="submit" class="btn">Enregistrer</button>
    </form>
  </div>
</div>
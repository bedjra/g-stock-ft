<nav class="onglets">
     <a (click)="ongletActif = 'config'" [ngClass]="{ 'active': ongletActif === 'config' }" class="nav-link">
        <i class="fas fa-cog"></i> Configuration
    </a>

    <a *ngIf="roleConnecte !== 'SECRETAIRE'" (click)="ongletActif = 'utilisateur'"
        [ngClass]="{ 'active': ongletActif === 'utilisateur' }" class="nav-link">
        ðŸ‘¤ Utilisateur
    </a>

    <a (click)="ongletActif = 'importation'" [ngClass]="{ 'active': ongletActif === 'importation' }" class="nav-link">
        ðŸ“‚ Importation & Inventaire
    </a>
</nav>


<div class="containe" *ngIf="ongletActif === 'config'">
    <div *ngFor="let config of configurations" class="config-card">
        <div class="card-content">
            <!-- Section Logo -->
            <div class="logo-section">
                <div class="logo-container">
                    <img *ngIf="config.logoUrl" [src]="config.logoUrl" class="logo-img" alt="Logo" />
                    <div *ngIf="!config.logoUrl" class="logo-placeholder">
                        <svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="1.5">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                            <circle cx="8.5" cy="8.5" r="1.5"></circle>
                            <polyline points="21 15 16 10 5 21"></polyline>
                        </svg>
                    </div>
                </div>
                <p class="logo-label">Logo</p>
            </div>

            <!-- Section Informations -->
            <div class="info-section">
                <h2 class="establishment-title">{{ config.nom }}</h2>

                <div class="info-grid">
                    <div class="info-item">
                        <label class="info-label">Adresse</label>
                        <p class="info-value">{{ config.adresse }}</p>
                    </div>

                    <div class="info-item">
                        <label class="info-label">TÃ©lÃ©phone 1</label>
                        <p class="info-value">{{ config.tel1 }}</p>
                    </div>

                    <div class="info-item">
                        <label class="info-label">TÃ©lÃ©phone 2</label>
                        <p class="info-value">{{ config.tel2 || 'â€”' }}</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<div class="container" *ngIf="ongletActif === 'utilisateur' && roleConnecte !== 'SECRETAIRE'">
    <div class="left-box">
        <h4>{{ isEditMode ? 'Modifier un utilisateur' : 'Ajouter un utilisateur' }}</h4>
        <form #formUser="ngForm" (ngSubmit)="isEditMode ? modifierUtilisateur() : ajouterUtilisateur()">
            <div class="form-group">
                <label for="roleUser">RÃ´le :</label>
                <select id="roleUser" [(ngModel)]="credentials.role" name="role" required>
                    <option value="" disabled selected>SÃ©lectionnez un rÃ´le</option>
                    <option *ngFor="let r of roles" [value]="r">{{ r | titlecase }}</option>
                </select>
            </div>

            <div class="form-group">
                <label for="emailUser">Nom :</label>
                <input type="text" id="emailUser" [(ngModel)]="credentials.email" name="email" required>
            </div>

            <div class="form-group">
                <label for="passwordUser">Mot de passe :</label>
                <input [type]="passwordVisible ? 'text' : 'password'" id="passwordUser"
                    [(ngModel)]="credentials.password" name="password" required autocomplete="off">
            </div>

            <div class="form-group">
                <label for="confirmPasswordUser">Confirmer le mot de passe :</label>
                <input [type]="passwordVisible ? 'text' : 'password'" id="confirmPasswordUser"
                    [(ngModel)]="credentials.confirmPassword" name="confirmPassword" required autocomplete="off">
            </div>



            <button type="submit" class="submit-btn"
                [disabled]="!formUser.valid || credentials.password !== credentials.confirmPassword">
                {{ isEditMode ? 'Mettre Ã  jour' : 'S\'inscrire' }}
            </button>

            <div *ngIf="credentials.password && credentials.confirmPassword && credentials.password !== credentials.confirmPassword"
                style="color: red;">
                Les mots de passe ne correspondent pas.
            </div>
        </form>
    </div>

    <div class="right-box">
        <h4>Gestion des Utilisateurs</h4>
        <table *ngIf="utilisateurs.length > 0">
            <thead>
                <tr>
                    <th>Id</th>
                    <th>RÃ´le</th>
                    <th>Nom</th>
                    <th>Mdp</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let u of utilisateurs; let i = index">
                    <td>{{ i + 1 }}</td>
                    <td>{{ u.role }}</td>
                    <td>{{ u.email }}</td>
                    <td>{{ u.password }}</td>

                    <td>
                        <button class="btn btn-sm btn-warning me-2" (click)="remplirFormulairePourModification(u, i)">
                            <i class="fas fa-edit"></i>
                        </button>
                        <br>
                        <button class="btn btn-sm btn-danger" (click)="supprimerUtilisateur(i)">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </td>


                </tr>
            </tbody>
        </table>
        <p *ngIf="utilisateurs.length === 0">Aucun utilisateur trouvÃ©.</p>
    </div>
</div>



<div class="container" *ngIf="ongletActif === 'importation'">
    <div class="leftbox">
        <div class="box">
        </div>

        <h4>Importer des produits</h4>
        <p>
            Ajoutez ou mettez Ã  jour des produits en masse Ã  partir d'un fichier Excel (.xlsx, .csv).
        </p>
        <!-- Importer un fichier -->
        <label class="btn-upload">
            ðŸ“‚ Importer un fichier
            <input type="file" hidden (change)="onFileSelected($event)" accept=".xlsx,.csv" />
        </label>

        <div *ngIf="fileName" class="preview-box">
            <p>Fichier sÃ©lectionnÃ© : {{ fileName }}</p>
            <button (click)="uploadFile()" class="btn-upload-confirm">Importer</button>
        </div>

        <div *ngIf="message" class="upload-message">
            {{ message }}
        </div>
    </div>
    <div class="rightbox">

        <!-- Bouton gÃ©nÃ©rer PDF -->

        <button (click)="genererPDF()" class="submit-btn">
            ðŸ“„ GÃ©nÃ©rer PDF de l'inventaire
        </button>





    </div>

</div>